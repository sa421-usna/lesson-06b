---
title: "Lesson 6b. More on Input Data Analysis"
author: "Assoc. Prof. D. Phillips and N. Uhan"
date: "SA421 -- Simulation Modeling -- Fall 2017"
output:
  html_notebook:
    css: css/sa421.css
---

# Computing goodness-of-fit criteria when fitting the uniform distribution

* Let's read in some data of unknown origin... 

```{r}
# Read in data
data <- read.csv('data.csv')

# What does this data look like?
print(data)
```

* Suppose we want to fit this data to a uniform distribution. We can use `fitdistrplus` as we did in Lesson 6:

```{r}
# Load fitdistrplus
library(fitdistrplus)

# Fit "something" to uniform distribution
unif.fit <- fitdist(data$something, "unif")
summary(unif.fit)

# Get goodness-of-fit statistics and criteria
unif.gof <- gofstat(unif.fit, fitnames = c('uniform'))
print(unif.gof)
```

* As we see above, `fitdistrplus` does __not__ automatically compute the maximum (log) likelihood, the AIC, or the BIC. ![](img/angry-face.png)

* Fortunately, computing these is not too hard to do.

* Suppose we have $n$ observations, $x_1, \dots, x_n$. Let 

$$
x_{\min} = \min \{x_1, \dots, x_n\} \quad \text{and} \quad x_{\max} = \max \{x_1, \dots, x_n\}.
$$

* The uniform distribution has $k = 2$ parameters to estimate, the left endpoint $a$ and the right endpoint $b$. 

* One can show that the maximum likelihood estimates for $a$ and $b$ are

$$
\widehat{a} = x_{\min} \quad \text{and} \quad \widehat{b} = x_{\max}
$$

* The corresponding log likelihood, AIC, and BIC are

$$
\begin{aligned}
\log \widehat{L} & = -n \log(x_{\max} - x_{\min})  \\
\text{AIC} & = 2 k - 2 \log \widehat{L} = 4 - 2 \log \widehat{L} \\
\text{BIC} & = k \log n - 2 \log \widehat{L} = 2 \log n - 2 \log \widehat{L}
\end{aligned}
$$

```{r}
# Load dplyr
library(dplyr)

# Compute loglikelihood, AIC and BIC manually

```

* So in this case, the log likelihood is <!-- Fill in the blank -->, the AIC is <!-- Fill in the blank -->, and the BIC is <!-- Fill in the blank -->.

# Adjusting the histograms

* You may find that you need to adjust the vertical axis of the histograms generated by `denscomp()`.

* You can accomplish this with the `ylim` argument, like this:

```{r}
denscomp(unif.fit, legendtext = c('uniform'), plotstyle='ggplot')

```